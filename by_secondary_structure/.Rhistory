library(caret)
set.seed(500)
setwd('C:/Users/Jan_Huang/Desktop/helix_grindtime/by_secondary_structure')
source('~/.active-rstudio-document')
coding <- read.csv('coding_final.csv')
noncoding <- read.csv('noncoding_final.csv')
compareLengths(coding)
compareLengths <- function(df) {
for (i in 1:nrow(df)) {
df$length[i] <- nchar(as.character(df$seq[i]))
hist(df$length)
summary(df$length)
}
}
compareLengths(coding)
compareLengths(coding)
hist(df$length)
compareLengths(coding, 'coding')
?hist
?max
max(coding$length)
View(coding)
for (i in 1:nrow(coding)) {
coding$length[i] <- nchar(as.character(coding$seq[i]))
}
for (i in 1:nrow(noncoding)) {
noncoding$length[i] <- nchar(as.character(noncoding$seq[i]))
}
View(coding)
View(noncoding)
hist(coding$length, main='Length of Coding Sequences')
max(coding$length)
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, max(coding$length)))
IQR()
IQR(coding$length)
?IQR
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 1000)
compareLengths <- function(df) {
for (i in 1:nrow(df)) {
df$length[i] <- nchar(as.character(df$seq[i]))
}
hist(df$length, xlim=c(0, max(df$length)))
summary(df$length)
}
compareLengths(coding)
compareLengths(noncoding)
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 1000))
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 5000))
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 10000))
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 10000), breaks=100)
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100)
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
noncoding <- noncoding[1:627, ]
for (i in 1:nrow(noncoding)) {
noncoding$length[i] <- nchar(as.character(noncoding$seq[i]))
}
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
boxplot(coding$length)
?boxplot
hist(noncoding$length, main='Length of Noncoding Sequences', breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlab='Length')
?boxplot
boxplot(coding$length, range=c(0,10000))
boxplot(coding$length, range=c(0,1000))
boxplot(coding$length, range=c(0,100))
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(coding$length, main='Length of Coding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
hist(noncoding$length, main='Length of Noncoding Sequences', xlim=c(0, 100000), breaks=100, xlab='Length')
View(coding)
coding <- coding$[-ID]
coding <- coding$(-ID)
coding <- coding[-ID]
coding <- coding(-ID,)
?drop
coding <- coding[-ID]
View(coding)
coding <- coding[-ID, ]
coding <- coding[,-ID]
coding <- subset(coding, select=c('seq', 'length'))
data <- cbind(coding, noncoding)
View(data)
data <- rbind(coding, noncoding)
View(data)
coding$code <- 1
View(coding)
noncoding$code <- 0
data <- rbind(coding, noncoding)
View(data)
?saveRDS
saveRDS(data, 'data.csv')
View(data)
?save
save(data, 'data.csv')
?write.csv
write.csv(data, 'data.csv')
?sum
coding <- coding %>% filter(length >= 45 && length < 50000)
?filter
library(dplyr)
coding <- read.csv('coding_final.csv')
noncoding <- read.csv('noncoding_final.csv')
for (i in 1:nrow(coding)) {
coding$length[i] <- nchar(as.character(coding$seq[i]))
}
for (i in 1:nrow(noncoding)) {
noncoding$length[i] <- nchar(as.character(noncoding$seq[i]))
}
coding <- coding %>% filter(length >= 45 && length < 50000)
coding <- read.csv('coding_final.csv')
coding <- coding %>% filter(length >= 45 && length < 50000)
coding <- coding %>% dplyr::filter(length >= 45 && length < 50000)
coding <- coding[coding$length >= 45 && coding$length < 50000, ]
coding <- coding[coding$length >= 100 && coding$length < 50000, ]
View(coding)
coding <- read.csv('coding_final.csv')
coding <- coding[coding$length >= 100, ]
coding <- read.csv('coding_final.csv')
for (i in 1:nrow(coding)) {
coding$length[i] <- nchar(as.character(coding$seq[i]))
}
coding <- coding[length >= 100, ]
coding <- coding[coding$length >= 100, ]
coding <- coding[coding$length >= 300, ]
min(coding$length)
coding <- read.csv('coding_final.csv')
for (i in 1:nrow(coding)) {
coding$length[i] <- nchar(as.character(coding$seq[i]))
}
min(coding$length)
noncoding <- read.csv('noncoding_final.csv')
for (i in 1:nrow(noncoding)) {
noncoding$length[i] <- nchar(as.character(noncoding$seq[i]))
}
min(noncoding$length)
coding <- coding[coding$length < 50000, ]
noncoding <- noncoding[noncoding$length >= 45, ]
min(noncoding$length)
?sample
fraction = nrow(coding) / nrow(noncoding)
fraction
nc_index <- sample(x = 1:nrow(noncoding), size = round(fraction * nrow(noncoding)))
noncoding <- noncoding[nc_index, ]
View(coding)
View(noncoding)
coding <- subset(coding, select=c('seq', 'length'))
coding$code <- 1
noncoding$code <- 0
data <- rbind(coding, noncoding)
write.csv(data, 'data.csv')
View(data)
disp <- read.csv('data_disp.csv')
data$disp <- disp
View(data)
hist(disp)
hist(data$disp)
hist(as.numeric(data$disp))
struc(data$disp)
class(data$disp)
class(data$disp[1])
for (i in 1:nrow(disp)) {
data$disp[i] <- disp[i]
}
for (i in 1:nrow(disp)) {
data$disp[i] <- disp[i, 0]
}
for (i in 1:nrow(disp)) {
data$disp[i] <- disp[i, ]
}
View(data)
disp <- as.matrix(read.csv('data_disp.csv'))
for (i in 1:nrow(disp)) {
data$disp[i] <- disp[i]
}
data <- read.csv('data.csv')
for (i in 1:nrow(disp)) {
data$disp[i] <- disp[i]
}
View(data)
data <- subset(data, select=c('seq', 'length', 'code'))
data <- read.csv('data.csv')
data <- subset(data, select=c('seq', 'length', 'code'))
for (i in 1:nrow(disp)) {
data$disp[i] <- disp[i]
}
hist(data$disp)
library(ggplot2)
ggplot(data=data, aes(data$disp)) + geom_histogram()
ggplot(data=data, aes(data$disp)) + geom_histogram(binwidth = 30)
ggplot(data=data, aes(data$disp)) + geom_histogram(binwidth = 1)
ggplot(data=data, aes(data$disp)) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$disp), fill) + geom_histogram(binwidth = .05, aes(fill=..count..))
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05, aes(fill=..count..))
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05)
data$code <- as.factor(data$code)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05, aes(fill=..count..))
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05)
GC <- as.matrix(read.csv('data_GC.csv'))
for (i in 1:nrow(GC)) {
data$GC[i] <- GC[i]
}
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = .5)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = .75)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$disp, fill=code, title='Median Disparity')) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$disp, fill=code, 'Median Disparity')) + geom_histogram(binwidth = .05)
?ggplot
ggplot(data=data, aes(data$disp, fill=code, 'Median Disparity')) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$disp, fill=code, main= 'Median Disparity')) + geom_histogram(binwidth = .05)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', xlab='Median Disparity')
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity')
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count')
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + geom_density(col=2)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + geom_density(col=1)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + geom_density(col=.1)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + geom_density(col=1)
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + scale_fill_discrete(name = "New Legend Title")
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + scale_fill_discrete(name = '')
?scale_fill_discrete
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + scale_fill_discrete(name = '', labels = c('coding', 'noncoding'))
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding'))
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding'))
?geom_density
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding')) + geom_density()
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding')) + geom_density(col=10)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding')) + geom_density(col=1)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding')) + geom_density(col=2)
?geom_density
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding')) + geom_density(data$GC)
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Coding', 'Noncoding'))
ggplot(data=data, aes(data$disp, fill=code)) + geom_histogram(binwidth = .05) + labs(title='Histogram of Median Disparity', x='Median Disparity', y='Count') + scale_fill_discrete(name = '', labels = c('Noncoding', 'Coding'))
ggplot(data=data, aes(data$GC, fill=code)) + geom_histogram(binwidth = 1.15) + labs(title='Histogram of GC Percentage', x='GC Percentage', y='Count') + scale_fill_discrete(name = '', labels = c('Noncoding', 'Coding'))
cor(data$disp, data$GC)
?cor
qplot(data$disp, data$GC)
?qplot
?ggplot
ggplot(data=data, aes(x=data$GC, y=data$disp, fill=data$disp))
ggplot(data=data, aes(x=data$GC, y=data$disp, fill=disp))
ggplot(data=data, aes(x=data$GC, y=data$disp))
?ggplot
ggplot(data=data, aes(x=data$GC, y=data$disp)) + geom_point
ggplot(data=data, aes(x=data$GC, y=data$disp)) + geom_point(aes(GC, disp))
ggplot(data=data, aes(x=data$GC, y=data$disp, fill=code)) + geom_point(aes(GC, disp))
ggplot(data=data, aes(x=data$GC, y=data$disp, fill=code)) + geom_point(aes(GC, disp, fill=code))
ggplot(data=data, aes(x=data$GC, y=data$disp)) + geom_point(aes(GC, disp, fill=code))
ggplot(data=data, aes(x=data$GC, y=data$disp)) + geom_point(aes(GC, disp, color=code))
cor(data$length, data$disp)
cor(data$length, data$GC)
cor(data$length, data$coding)
cor(data$length, data$code)
